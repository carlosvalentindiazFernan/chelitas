<link rel="import" href="../../bower_components/polymer/polymer-element.html">
<link rel="import" href="../../bower_components/polymer/lib/mixins/gesture-event-listeners.html">
<link rel="import" href="../../bower_components/polymer/lib/elements/dom-if.html">
<link rel="import" href="../../bower_components/paper-input/paper-input.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<script src="../../bower_components/firebase/firebase.js"></script>
<dom-module id="login-c">
    <template>
        <style>
            :host{
                width: 100%;
                height: 100%;
                display: flex;
                flex-direction: column;
                justify-content: center;
                align-items: center;
                background-color: rgba(0,0,0,0.7);
                color: #F4810A;
            }
            paper-input{
                margin-bottom: 10px;
                width: 80%;
                --paper-input-container-focus-color: #F4810A;
                --paper-input-container-input-color: #EBEBEBEB;
                --paper-input-container-color: #EBEBEBEB;
                --paper-input-container-invalid-color: #E50000;
                --paper-input-container-underline: #F4810A;
                margin: 0 auto;
            }
            paper-button{
                width: 81%;
                margin-top: 20px;
                background-color: #F4810A;
                border-right: 1px solid #1E1B1B;
                color: #1E1B1B;
                font-weight: bolder;
            }
            .title{
                width: 95%;
                margin-top: 100px;
                text-align: center;
                background-color: #EBEBEB;
            }
            .login{
                width: 95%;
                height: 100%;
                margin-bottom: 100px;
                text-align: center;
                display: flex;
                flex-direction: row;
                justify-content: center;
                border-radius: 10px;
            }
            .email{
                width: 65%;
                display: flex;
                flex-direction: column;
                justify-content: center;
                align-items: center;
                background-color: #1E1B1B;
                color: #EBEBEB;
            }
            .actions{
                width: 81%;
                margin-top: 10px;
                display: flex;
                flex-direction: row;
            }
            .register{
                width: 30%;
                margin: 0px;
                margin-top: 10px;
                margin-right: 5px;
                margin-bottom: 20px;
                background-color: #EBEBEB;
            }
            .forgot{
                width: 70%;
                margin: 0px;
                margin-top: 10px;
                margin-left: 5px;
                margin-bottom: 20px;
                background-color: #EBEBEB;
            }
            .social{
                width: calc(35% - 10px);
                padding: 10px;
                display: flex;
                flex-direction: column;
                justify-content: center;
                align-items: center;
                background-color: #EBEBEB;
                color: #EBEBEB;
            }
            .facebook{
                width: 90%;
                height: 43px;
                background-color: #3B5998;
                color: #FFFFFF;
                border-radius: 3px;
                font-weight: bold;
                border-right: 0;
                margin-top: 0px;
            }
            .google{
                width: 90%;
                height: 43px;
                background-color: #D94A38;
                color: #FFFFFF;
                border-radius: 3px;
                font-weight: bold;
                border-right: 0;
                margin-top: 20px;
            }
        </style>
            <div class="title">
                <h3>Login</h3>
            </div>
            <div class="login">
                <div class="email">
                    <paper-input autofocus="true" label-float="" label="Email"></paper-input>
                    <paper-input label-float="" label="Password"></paper-input>
                    <paper-button>Submit</paper-button>
                    <div class="actions">
                        <paper-button class="register">Register</paper-button>
                        <paper-button class="forgot">Forgot Password</paper-button>
                    </div>
                </div>
                <div class="social">
                    <paper-button class="facebook" on-tap="signFacebook">Facebook</paper-button>
                    <paper-button class="google" on-tap="signGoogle">Google</paper-button>
                </div>
            </div>
    </template>
    <script>
        (function loginChelitasDefinition(customElements){
            class LoginChelitas extends Polymer.GestureEventListeners(Polymer.Element){
                static get is(){ return 'login-c'; }

                static get properties(){
                    return{
                        login: {
                            type: String,
                            observer: '_signin'
                        }
                    };
                }

                connectedCallback(){
                    let config = {
                        apiKey: "AIzaSyDxcYm507yFlbsKtXJNQ7tDjxXf_HIJAR8",
                        authDomain: "chelitas-24648.firebaseapp.com",
                        databaseURL: "https://chelitas-24648.firebaseio.com",
                        projectId: "chelitas-24648",
                        storageBucket: "chelitas-24648.appspot.com",
                        messagingSenderId: "220775801818"
                    };
                    firebase.initializeApp(config);
                }

                signFacebook(){
                    this.login = "Facebook";
                }

                signGoogle(){
                    this.login = "Google";
                }

                _signin(){
                    switch (this.login){
                        case "Facebook":{
                            this._signinfacebook();
                        }
                        case "Google":{
                            this._signingoogle();
                        }
                        default:{
                            console.log(this.login);
                        }
                    }
                }

                _signingoogle(){
                    let provider = new firebase.auth.GoogleAuthProvider();
                    provider.addScope('https://www.googleapis.com/auth/contacts.readonly');
                    firebase.auth().signInWithPopup(provider).then(function(result) {
                        let token = result.credential.accessToken;
                        let secret = result.credential.secret;
                        let user = result.user;
                        if(user){
                            console.log("google");
                            console.log(user);
                        }
                    }).catch(function(error) {
                        let errorCode = error.code;
                        let errorMessage = error.message;
                        let email = error.email;
                        let credential = error.credential;
                        console.log(credential);
                    });
                }

                _signinfacebook(){
                    let provider = new firebase.auth.FacebookAuthProvider();
                    firebase.auth().signInWithPopup(provider).then(function(result) {
                        let token = result.credential.accessToken;
    		            let secret = result.credential.secret;
                        let user = result.user;
                        if(user){
                            console.log("facebook");
                            console.log(user);
                        }
                    }).catch(function(error) {
                        let errorCode = error.code;
    		            let errorMessage = error.message;
                		let email = error.email;
                		let credential = error.credential;
                		console.log(credential);
                	});
                }
            }
            customElements.define(LoginChelitas.is, LoginChelitas);
        })(window.customElements);
    </script>
</dom-module>
